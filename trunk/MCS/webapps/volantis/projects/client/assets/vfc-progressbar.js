
Widget.ProgressBar=Class.create();Object.extend(Widget.ProgressBar.prototype,Widget.Appearable);Object.extend(Widget.ProgressBar.prototype,Widget.Disappearable);Object.extend(Widget.ProgressBar.prototype,Widget.Refreshable);Object.extend(Widget.ProgressBar.prototype,{initialize:function(id,options){MIN_PROGRESS=parseInt(0,10);MAX_PROGRESS=parseInt(100,10);this.id=id;this.el=$(id);this.usesPolling=false;this.setup();Object.copyFields(this,options||{});this.startRefresh();this.progressValue=MIN_PROGRESS;this.locked=false;},setup:function(){this.el.innerHTML="<div style='width:0; height:100%; background-color: "+
this.el.getStyle('color')+";'></div>";},getProgressValue:function(){return this.progressValue;},setProgressValue:function(newValue){var progressValue=parseInt(newValue,10);if(isNaN(progressValue)){return;}
if(progressValue<MIN_PROGRESS){progressValue=MIN_PROGRESS;}else if(progressValue>MAX_PROGRESS){progressValue=MAX_PROGRESS;}
this.progressValue=progressValue;},processAJAXResponse:function(originalRequest){var myObject=eval('('+originalRequest.responseText+')');this.setProgressValue(myObject.percentage);this.refreshBAR();if(this.getProgressValue()>=MAX_PROGRESS){this.disableUpdates();}},refreshBAR:function(){this.el.firstChild.style.width=this.getProgressValue()+'%';},show:function(){if(this.el.getStyle('visibility')=='hidden'){this.el.style.display='none';this.el.style.visibility='visible';}
if(this.el.style.display!='none'||this.locked){return;}
this.locked=true;var id=this.id;Widget.TransitionFactory.createAppearEffect(this.el,this,{afterFinish:function(effect){Widget.getInstance(id).locked=false;}});},hide:function(){if(this.el.style.display=='none'||this.locked){return;}
this.locked=true;var id=this.id;Widget.TransitionFactory.createDisappearEffect(this.el,this,{afterFinish:function(effect){Widget.getInstance(id).locked=false;}});},set:function(newValue){this.setProgressValue(newValue);this.refreshBAR();this.disableUpdates();},get:function(){return this.getProgressValue();},reset:function(){this.setProgressValue(MIN_PROGRESS);this.refreshBAR();this.disableUpdates();},finish:function(){this.setProgressValue(MAX_PROGRESS);this.refreshBAR();this.disableUpdates();},progress:function(delta){var deltaValue=parseInt(delta,10);this.set(this.get()+deltaValue);}});