<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html><head><meta http-equiv="Content-Type" content="text/xml;charset=UTF-8"/><meta name="taskref" content="025"/><title>Controlling page caching</title><link rel="stylesheet" href="../volantis.css"/></head><body><h1>Controlling page caching</h1>
      <p>In the XDIME <span class="code">canvas</span> element, you can use the <span class="code">cacheScope</span>
         attribute to enable or disable the caching of the rendered XDIME page. In XDIME 2 you
         control content caching with the <span class="code">meta</span> element.</p>
      <p>The goal of page caching is to improve performance, but there are some circumstances in
         which page caching is not advisable. This topic outlines the caching operation, discusses
         some performance issues and suggests an approach to setting cache values.</p>
      <div class="note"><strong>Note</strong>: Page caching is not supported for JSPs, WMLC documents or portlets.</div>
      
         <h2>Caching operation</h2>
         <p>For the first request for a page, the content caching operation caches the results of
            rendering a page for a particular device, fragmentation and dissection state.
            The cached material is in the markup of the target device, not the original XDIME page
            or any results of pipeline operations.</p>
         <p>The source is processed in the usual way to create the output ready to be rendered.
            Rendering for the target device is carried out in MCS and the results are cached in
            addition to being returned to the requester.</p>
         <p>If a subsequent request for the same URL in the same fragmentation and dissection state
            from the same type of device is received, the  document is checked just before
            rendering. If the XDIME is the same as the XDIME that created the cached page, the
            cached version is returned to the requester and rendering is avoided.</p>
      
      
         <h2>Performance</h2>
         <p>For static pages there is a better case for using page caching than for pages with
            content that is known to be dynamic. The dynamic content may produce a different cache
            key for requests from identical devices, defeating the goal of caching. Also, the time
            taken to evaluate subsequent requests with complex pipeline operations may exceed the
            potential gain made by not having to render the page.</p>
      
      
         <h2>Setting cache values</h2>
         <p>The default value for page caching is set in the <span class="code">defaultScope</span> attribute on
            the <span class="code">page-cache</span> element in the <span class="filepath">mcs-config.xml</span>
            file. The default for the default attribute is 'none'. You can override this value, or
            any other default value that has been set, with three possible values for the
               <span class="code">cacheScope</span> attribute on the <span class="code">canvas</span> element for
            individual pages. The 'optimistic' and 'safe' values enable caching for the page, and
            affect the way that MCS calculates a cache key on the XDIME content.</p>
         <dl>
            <dt>optimistic</dt>
            <dd>The cache key is calculated on the basic XDIME page, before any pipeline processing.
               Some performance gains will be made, since only the basic page forms the key, but
               there is a risk that outdated content will be rendered from the cache. So this
               setting is suited for static pages or simple transform operations in the pipeline,
               when the transform result is predictably consistent. It should not be used where the
               basic page references other documents or content sources, unless they are also
               static.</dd>
            <dt>safe</dt>
            <dd>The cache key is calculated after all pipeline operations. Any variations in content
               owing to external factors will cause multiple caches for a given device. This setting
               is suited to situations where, for example, you want to ensure that the most recently
               cached version is served.</dd>
            <dt>none</dt>
            <dd>MCS will never cache the page. Use this setting when security and privacy issues
               make it important that pages are not rendered other than for the original
            request.</dd>
         </dl>

      
      
         <h2>Caching XDIME 2 pages</h2>
         <p>In XDIME 2 you control caching with the <span class="code">meta</span> tag inside the
               <span class="code">head</span> element, with the <span class="code">property</span> attribute set to
            mcs:cache-scope, and the element content taking the same values as the
               <span class="code">cacheScope</span> on the <span class="code">canvas</span> element. If you choose a 'safe' or an 'optimistic' cache-scope,
            then you can also set the age of the cache with the mcs:max-age property and the
            element content in seconds.</p>
         <pre class="code">&lt;html&gt;
   &lt;head&gt;
      &lt;title&gt;About XDIME 2&lt;/title&gt;
      &lt;meta property="mcs:cache-scope"&gt;optimistic&lt;/meta&gt;
      &lt;meta property="mcs:max-age"&gt;180&lt;/meta&gt;
      ...       
   &lt;/head&gt;
&lt;/html&gt;</pre>
      
      
         <p><span class="ri">Related topics</span><br/><a href="../wag/wag_xdime_about.html">Working with XDIME</a><br/><a href="../xdime/xdime_canvas.html">canvas</a><br/><a href="../xdime_cp/xh2_meta.html">meta</a></p>
      
   </body></html>